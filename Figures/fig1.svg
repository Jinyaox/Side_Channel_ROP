<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="877px" height="612px" viewBox="-0.5 -0.5 877 612" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2023-08-25T15:55:57.430Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.6 Safari/605.1.15&quot; etag=&quot;66ErRsNbXIYznE-5Lwqz&quot; version=&quot;21.6.9&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;bL2ti3FS8Qn9a3gcwUtS&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 445 90.5 L 463 90.53 L 463 45.46 L 485 45.5 M 485 49.5 L 467 49.47 L 467 94.54 L 445 94.5 M 485 49.5" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="1.42" pointer-events="all"/><path d="M 365 475 L 395 475 L 395 535 L 418.63 535" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 423.88 535 L 416.88 538.5 L 418.63 535 L 416.88 531.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="0" y="205" width="425" height="185" rx="27.75" ry="27.75" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="15" y="212.5" width="380" height="170" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 378px; height: 1px; padding-top: 298px; margin-left: 17px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px; font-size: 14px;"><span style="background-color: rgb(255, 255, 255);"><font style="font-size: 14px;">void function(char* mal_input){</font></span></div><div style="font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px; font-size: 14px;"><span style="background-color: rgb(255, 255, 255);"><font style="font-size: 14px;"><span style="white-space: pre;">	char[64] buffer;</span><br /></font></span></div><div style="line-height: 18px; font-size: 14px;"><span style="background-color: rgb(255, 255, 255);"><font face="Menlo, Monaco, Courier New, monospace" style="font-size: 14px;"><span style="white-space: pre;">	for(int i=0;i&lt;strlen(mal_input);i++){</span></font></span></div><div style="line-height: 18px; font-size: 14px;"><span style="background-color: rgb(255, 255, 255);"><font face="Menlo, Monaco, Courier New, monospace" style="font-size: 14px;"><span style="white-space: pre;"><span style="white-space: pre;">	<span style="white-space: pre;">	<font color="#ff3333" style="font-size: 14px;">//the buffer was overflown</font></span></span><br /></span></font></span></div><div style="line-height: 18px; font-size: 14px;"><span style="background-color: rgb(255, 255, 255);"><font face="Menlo, Monaco, Courier New, monospace" style="font-size: 14px;"><span style="white-space: pre;"><span style="white-space: pre;"><span style="white-space: pre;"><font color="#ff3333" style="font-size: 14px;"><span style="white-space: pre;">	<span style="white-space: pre;">	  stack address re-written</span></span><br /></font></span></span></span></font></span></div><div style="line-height: 18px; font-size: 14px;"><span style="background-color: rgb(255, 255, 255);"><font face="Menlo, Monaco, Courier New, monospace" style="font-size: 14px;">		<span style="white-space: pre;">	<span style="white-space: pre;">	</span>buffer[i]=mal_input[i];</span></font></span></div><div style="line-height: 18px; font-size: 14px;"><font style="font-size: 14px;"><span style="white-space: pre; font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace;">	</span><span style="white-space: pre; font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; background-color: rgb(255, 255, 255);">}</span></font></div><div style="line-height: 18px; font-size: 14px;"><span style="white-space: pre; font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; background-color: rgb(255, 255, 255);"><font style="font-size: 14px;"><span style="white-space: pre;">	return;</span><br /></font></span></div><div style="font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px; font-size: 14px;"><span style="background-color: rgb(255, 255, 255);"><font style="font-size: 14px;">}</font></span></div></div></div></div></foreignObject><text x="17" y="301" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">void function(char* mal_input){...</text></switch></g><path d="M 485 142.5 L 465 142.54 L 465 265 L 478.63 265" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 483.88 265 L 476.88 268.5 L 478.63 265 L 476.88 261.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="485" y="0" width="350" height="190" rx="28.5" ry="28.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 348px; height: 1px; padding-top: 95px; margin-left: 487px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><blockquote style="margin: 0px 0px 0px 40px; border: medium; padding: 0px; font-size: 14px;"><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);">gadget1:</span></div><div style="border-color: var(--border-color); line-height: 18px;"><div style="font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><div><span style="background-color: rgb(255, 255, 255);">movw r6, r20</span></div><div><span style="background-color: rgb(255, 255, 255);">sub  r6, r24</span></div><div><span style="background-color: rgb(255, 255, 255);">sbc  r7, r25</span></div><div><span style="background-color: rgb(255, 255, 255);">movw r4, r6</span></div><div><span style="background-color: rgb(255, 255, 255);">ldi  r17, 0xFF   ; 255</span></div><div><span style="background-color: rgb(255, 255, 255);">sub  r4, r17</span></div><div><span style="background-color: rgb(255, 255, 255);">sbc  r5, r17</span></div><div><span style="background-color: rgb(255, 255, 255);">jmp gadget2Â <font color="#ff3333" style="font-size: 14px;">//return to next gadget</font></span></div></div></div></blockquote></div></div></div></foreignObject><text x="487" y="99" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">gadget1:...</text></switch></g><rect x="485" y="230" width="290" height="70" rx="10.5" ry="10.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 265px; margin-left: 487px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);">gadget2:</span></div><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);">//malicious codes &amp; behaviors</span></div><div style="border-color: var(--border-color); line-height: 18px;"><div style="font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><br /></div></div></blockquote></div></div></div></foreignObject><text x="487" y="269" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">gadget2:...</text></switch></g><path d="M 425 341.75 L 443 341.77 L 443 154.54 L 273 154.54 L 273 75.46 L 295 75.5 M 295 79.5 L 277 79.47 L 277 150.54 L 447 150.54 L 447 345.77 L 425 345.75 M 295 79.5" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="1.42" pointer-events="all"/><rect x="295" y="70" width="150" height="30" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 85px; margin-left: 296px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Illegal Return Route</div></div></div></foreignObject><text x="370" y="89" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Illegal Return Route</text></switch></g><rect x="425" y="460" width="450" height="150" rx="22.5" ry="22.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 448px; height: 1px; padding-top: 535px; margin-left: 427px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><blockquote style="margin: 0px 0px 0px 40px; border: medium; padding: 0px; font-size: 14px;"><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);">void process_input(char* buffer, char* input){</span></div><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);"><span style="white-space: pre;">	function(buffer, input);</span><br /></span></div><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);"><span style="white-space: pre;"><span style="white-space: pre;">	<font color="#ff3333" style="font-size: 14px;">//legal return position</font></span><br /></span></span></div><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);"><span style="white-space: pre;"><span style="white-space: pre;">	check_validity(buffer);</span><br /></span></span></div><div style="border-color: var(--border-color); font-family: Menlo, Monaco, &quot;Courier New&quot;, monospace; line-height: 18px;"><span style="background-color: rgb(255, 255, 255);">}</span></div></blockquote></div></div></div></foreignObject><text x="427" y="539" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">void process_input(char* buffer, char* input){...</text></switch></g><path d="M 212.5 390 L 212.54 430.08 L 195 430.08 L 195 475 L 208.63 475" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 213.88 475 L 206.88 478.5 L 208.63 475 L 206.88 471.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="215" y="460" width="150" height="30" fill="none" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 475px; margin-left: 216px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Legal Return Route</div></div></div></foreignObject><text x="290" y="479" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Legal Return Route</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>